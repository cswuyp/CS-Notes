* [一、索引](#一索引)
    * [B+ Tree 原理](#b-tree-原理)
    * [MySQL 索引](#mysql-索引)
    * [索引优化](#索引优化)
    * [索引的优点](#索引的优点)
    * [索引的使用条件](#索引的使用条件)



* [MySQL为什么要用B+树来存储索引而不用hash或者红黑树](#MySQL为什么要用B+树来存储索引而不用hash或者红黑树)


# 一、索引
## B+ Tree 原理
B Tree指的是Balance Tree，就是平衡树。平衡树是一棵查找树，并且所有叶子节点位于同一层。  
B+ Tree是基于B Tree和叶子节点顺序访问指针进行实现，它具有B Tree的平衡性，并且通过顺序访问指针来提高区间查询的性能。  
在B+ Tree中，一个节点中的Key从左到右非递减排列，如果某个指针的左右相邻Key分别是Key<sub>i</sub>和Key<sub>i+1</sub>,且不为null，则该指针指向节点的所有Key大于等于Key<sub>i</sub>且小于小于等于Keysub>i+1</sub>。

进行查找操作时，首先在根节点进行二分查找，找打一个Key所在的指针，然后递归地在指针所指向的节点进行查找。直到查找到叶子节点，然后在叶子节点上进行二分查找，找到Key所对应的data。

插入删除操作会破坏平衡树的平衡性，因此在插入删除操作之后，需要对树进行一个分裂、合并、旋转等操作来维护平衡性。

# MySQL 索引
索引是在存储引擎层实现的，而不是在服务器层实现的，所以不同的存储引擎具有不同的索引类型和实现。

（1）B+ Tree索引  
是大多数MySQL存储引擎的默认索引类型。  

因为不再需要进行全表扫描，只需要对树进行搜索即可，所以查找速度快很多。

除了用于查找，还可以用于排序和分组。  

可以指定多个序列作为索引列


# MySQL为什么要用B+树来存储索引而不用hash或者红黑树

（1）减少查找次数  

平衡树查找操作的时间复杂度和树高 h 相关，O(h)=O(logdN)，其中 d 为每个节点的出度。  
红黑树的出度为 2，而 B+ Tree 的出度一般都非常大，所以红黑树的树高 h 很明显比 B+ Tree 大非常多，查找的次数也就更多。  
（2）利用磁盘预读特性

为了减少磁盘 I/O 操作，磁盘往往不是严格按需读取，而是每次都会预读。预读过程中，磁盘进行顺序读取，顺序读取不需要进行磁盘寻道，并且只需要很短的旋转时间，速度会非常快。  
操作系统一般将内存和磁盘分割成固定大小的块，每一块称为一页，内存与磁盘以页为单位交换数据。数据库系统将索引的一个节点的大小设置为页的大小，使得一次 I/O 就能完全载入一个节点。并且可以利用预读特性，相邻的节点也能够被预先载入。  
而如果把d值趋向于很大，则此时会变成一个数组，相当于hash，如果只是选取一个数据且内存足够一次性存放所有数据的时候且是hash更优，但是在实际业务场景上我们每次都不是但只选取一个数据且内存都不能满足一次性存放所有数据。  
因此,MySQL使用B+ Tree的的优点是可以一次选取多个数据且分批载入数据。


